<html lang="en">
<head>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

</head>
<style>
.dashboard-container {
    padding: 24px;
    max-width: 1200px;
    margin: 0 auto;
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 24px;
}

.stats-card {
    background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
    position: relative;
    overflow: hidden;
}

.stats-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, #10b981 0%, #34d399 100%);
}

.stats-card:hover {
    transform: translateY(-2px);
}

@media (max-width: 768px) {
    .dashboard-container {
        padding: 16px;
    }
    
    .stats-grid {
        grid-template-columns: 1fr;
        gap: 16px;
    }
    
    .stats-card {
        padding: 20px;
    }
}
</style>
<body class="lg:ml-52 ">
    <!-- Welcome Section -->
    <div class="welcome-section mb-6">
        <h1 class="text-2xl font-bold text-gray-800 mb-2">Halo, <%= user.name %>ðŸ‘‹</h1>
    </div>

    <!-- Stats Cards Section -->
    <div class="stats-grid mb-8">
        <!-- User Count Card -->
        <div class="stats-card bg-white rounded-xl shadow-lg p-6 border border-gray-100 hover:shadow-xl transition-shadow duration-300">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <!-- Avatar Icon -->
                    <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center">
                        <svg class="w-8 h-8 text-blue-600" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                        </svg>
                    </div>
                    
                    <!-- Stats Content -->
                    <div>
                        <p class="text-gray-500 text-sm font-medium mb-1">Total Penghuni</p>
                        <p class="text-3xl font-bold text-gray-800"><%= totalMahasiswaAktif.toLocaleString() %></p>
                        <div class="flex items-center mt-2">
                            <% if (perubahanPenghuni > 0) { %>
                                <svg class="w-4 h-4 text-green-500 mr-1" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M5.293 9.707a1 1 0 010-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 01-1.414 1.414L11 7.414V15a1 1 0 11-2 0V7.414L6.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                                </svg>
                                <span class="text-sm text-green-600 font-medium">+<%= perubahanPenghuni %></span>
                            <% } else if (perubahanPenghuni < 0) { %>
                                <svg class="w-4 h-4 text-red-500 mr-1" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M14.707 10.293a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 111.414-1.414L9 12.586V5a1 1 0 012 0v7.586l2.293-2.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                                </svg>
                                <span class="text-sm text-red-600 font-medium"><%= perubahanPenghuni %></span>
                            <% } else { %>
                                <span class="text-sm text-gray-500 font-medium">- 0</span>
                            <% } %>
                            <span class="text-sm text-gray-500 ml-1">minggu ini</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

       <div class="stats-card bg-white rounded-xl shadow-lg p-6 border border-gray-100 hover:shadow-xl transition-shadow duration-300">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center">
                        <i class="fas fa-check-circle text-green-600 text-2xl"></i>
                    </div>
                    <div>
                        <p class="text-gray-500 text-sm font-medium mb-1">Total Surat Bebas Asrama (Selesai)</p>
                        <p class="text-3xl font-bold text-gray-800"><%= totalSelesai.toLocaleString() %></p>
                        <div class="flex items-center mt-2">
                            <% if (perubahanSelesai > 0) { %>
                                <i class="fas fa-arrow-up text-green-500 mr-1"></i>
                                <span class="text-sm text-green-600 font-medium">+<%= perubahanSelesai %></span>
                            <% } else { %>
                                <span class="text-sm text-gray-500 font-medium">- 0</span>
                            <% } %>
                            <span class="text-sm text-gray-500 ml-1">minggu ini</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

                
        <div class="stats-card bg-white rounded-xl shadow-lg p-6 border border-gray-100 hover:shadow-xl transition-shadow duration-300">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <div class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center">
                        <i class="fas fa-tools text-red-600 text-2xl"></i>
                    </div>
                    <div>
                        <p class="text-gray-500 text-sm font-medium mb-1">Total Laporan Kerusakan (Selesai)</p>
                        <p class="text-3xl font-bold text-gray-800"><%= totalPelaporan.toLocaleString() %></p>
                        
                        <div class="flex items-center mt-2">
                            <% if (perubahanPelaporan > 0) { %>
                                <i class="fas fa-arrow-up text-green-500 mr-1"></i>
                                <span class="text-sm text-green-600 font-medium">+<%= perubahanPelaporan %></span>
                            <% } else { %>
                                <span class="text-sm text-gray-500 font-medium">- 0</span>
                            <% } %>
                            <span class="text-sm text-gray-500 ml-1">minggu ini</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
       
    </div>
    
        <div class="mt-8 bg-white rounded-xl shadow-lg p-6 border border-gray-100 w-full lg:w-1/3">
            <h3 class="text-lg font-semibold text-gray-800 mb-4">Distribusi Jurusan Penghuni</h3>
            <div>
                <canvas id="jurusanChart"></canvas>
            </div>
        </div>
</body>

<script>
    // Pastikan DOM sudah siap
    document.addEventListener('DOMContentLoaded', function () {
        // Ambil data yang dikirim dari controller
        const labels = <%- JSON.stringify(labelsJurusan) %>;
        const dataCounts = <%- JSON.stringify(countsJurusan) %>;

        const ctx = document.getElementById('jurusanChart').getContext('2d');
        
        new Chart(ctx, {
            type: 'bar', // Tipe chart adalah bar chart
            data: {
                labels: labels, // Label untuk sumbu X (Nama Jurusan)
                datasets: [{
                    label: 'Jumlah Mahasiswa',
                    data: dataCounts, // Data untuk sumbu Y (Jumlah)
                    backgroundColor: 'rgba(59, 130, 246, 0.5)', // Warna bar
                    borderColor: 'rgba(59, 130, 246, 1)',      // Warna border bar
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true, // Mulai sumbu Y dari 0
                        ticks: {
                            // Pastikan hanya angka bulat yang ditampilkan di sumbu Y
                            stepSize: 1 
                        }
                    }
                },
                plugins: {
                    legend: {
                        display: false // Sembunyikan legenda 'Jumlah Mahasiswa'
                    }
                }
            }
        });
    });
</script>
</html>
